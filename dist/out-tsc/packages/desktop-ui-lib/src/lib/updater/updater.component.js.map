{"version":3,"file":"updater.component.js","sourceRoot":"","sources":["../../../../../../../packages/desktop-ui-lib/src/lib/updater/updater.component.ts"],"names":[],"mappings":";;;;AAAA,wCAOuB;AACvB,mDAAuD;AAQhD,IAAM,gBAAgB,8BAAtB,MAAM,gBAAgB;IAG5B,YACS,eAAgC,EAChC,OAAe;QADf,oBAAe,GAAf,eAAe,CAAiB;QAChC,YAAO,GAAP,OAAO,CAAQ;QAExB,YAAO,GAAG,OAAO,CAAC;QAClB,YAAO,GAAG,KAAK,CAAC;QAChB,iBAAY,GAAG,KAAK,CAAC;QACrB,YAAO,GAAG,oBAAoB,CAAC;QAC/B,mBAAc,GAAG,KAAK,CAAC;QACvB,gBAAW,GAAQ,EAAE,CAAC;QACtB,cAAS,GAAY,KAAK,CAAC;IAPxB,CAAC;IASJ,QAAQ;QACP,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,EAAE,CAAC,sBAAsB,EAAE,GAAG,EAAE,CAChE,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE;YACrB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,OAAO,GAAG,oBAAoB,CAAC;YACpC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpC,IAAI,CAAC,cAAc,EAAE,CAAC;QACvB,CAAC,CAAC,CACF,CAAC;QAEF,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,EAAE,CAAC,kBAAkB,EAAE,GAAG,EAAE,CAC5D,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE;YACrB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,OAAO,GAAG,kBAAkB,CAAC;YAClC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpC,IAAI,CAAC,cAAc,EAAE,CAAC;QACvB,CAAC,CAAC,CACF,CAAC;QAEF,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,EAAE,CAAC,mBAAmB,EAAE,GAAG,EAAE,CAC7D,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE;YACrB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,OAAO,GAAG,2BAA2B,CAAC;YAC3C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpC,IAAI,CAAC,cAAc,EAAE,CAAC;YACtB,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;YAC3B,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACtB,CAAC,CAAC,CACF,CAAC;QAEF,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,EAAE,CAClC,sBAAsB,EACtB,CAAC,KAAK,EAAE,GAAG,EAAE,EAAE,CACd,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE;YACrB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,OAAO,GAAG,sBACd,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CACjD,GAAG,CAAC;YACJ,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACpC,IAAI,CAAC,cAAc,EAAE,CAAC;QACvB,CAAC,CAAC,CACH,CAAC;QACF,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC;IAC7D,CAAC;IAED,cAAc;QACb,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QACpB,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;IAC3D,CAAC;IAED,gBAAgB;QACf,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;IAC7D,CAAC;IAED,YAAY,CAAC,CAAC;QACb,IAAI,CAAC,EAAE;YACN,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SACvB;aAAM;YACN,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;SACtB;IACF,CAAC;IAEO,cAAc;QACrB,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,SAAS;YAClC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,YAAY,CAAC;IACzC,CAAC;CACD,CAAA;AAhFqB;IAApB,IAAA,gBAAS,EAAC,QAAQ,CAAC;sCAAS,iBAAU;gDAAC;AAChB;IAAvB,IAAA,gBAAS,EAAC,WAAW,CAAC;;sDAAc;2BAFzB,gBAAgB;IAN5B,IAAA,gBAAS,EAAC;QACV,QAAQ,EAAE,aAAa;QACvB,WAAW,EAAE,0BAA0B;QACvC,SAAS,EAAE,CAAC,0BAA0B,CAAC;QACvC,eAAe,EAAE,8BAAuB,CAAC,MAAM;KAC/C,CAAC;6CAKyB,0BAAe;QACvB,aAAM;GALZ,gBAAgB,CAiF5B","sourcesContent":["import {\r\n\tComponent,\r\n\tOnInit,\r\n\tChangeDetectionStrategy,\r\n\tViewChild,\r\n\tElementRef,\r\n\tNgZone,\r\n} from '@angular/core';\r\nimport { ElectronService } from '../electron/services';\r\n\r\n@Component({\r\n\tselector: 'ngx-updater',\r\n\ttemplateUrl: './updater.component.html',\r\n\tstyleUrls: ['./updater.component.scss'],\r\n\tchangeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class UpdaterComponent implements OnInit {\r\n\t@ViewChild('logBox') logBox: ElementRef;\r\n\t@ViewChild('logUpdate') logAccordion;\r\n\tconstructor(\r\n\t\tprivate electronService: ElectronService,\r\n\t\tprivate _ngZone: NgZone\r\n\t) {}\r\n\tversion = '0.0.0';\r\n\tloading = false;\r\n\tnotAvailable = false;\r\n\tmessage = 'Application Update';\r\n\tdownloadFinish = false;\r\n\tlogContents: any = [];\r\n\tlogIsOpen: boolean = false;\r\n\r\n\tngOnInit(): void {\r\n\t\tthis.electronService.ipcRenderer.on('update-not-available', () =>\r\n\t\t\tthis._ngZone.run(() => {\r\n\t\t\t\tthis.notAvailable = true;\r\n\t\t\t\tthis.message = 'Application Update';\r\n\t\t\t\tthis.logContents.push(this.message);\r\n\t\t\t\tthis.scrollToBottom();\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tthis.electronService.ipcRenderer.on('update_available', () =>\r\n\t\t\tthis._ngZone.run(() => {\r\n\t\t\t\tthis.notAvailable = true;\r\n\t\t\t\tthis.message = 'Update Available';\r\n\t\t\t\tthis.logContents.push(this.message);\r\n\t\t\t\tthis.scrollToBottom();\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tthis.electronService.ipcRenderer.on('update_downloaded', () =>\r\n\t\t\tthis._ngZone.run(() => {\r\n\t\t\t\tthis.notAvailable = true;\r\n\t\t\t\tthis.message = 'Update Download Completed';\r\n\t\t\t\tthis.logContents.push(this.message);\r\n\t\t\t\tthis.scrollToBottom();\r\n\t\t\t\tthis.downloadFinish = true;\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tthis.electronService.ipcRenderer.on(\r\n\t\t\t'download_on_progress',\r\n\t\t\t(event, arg) =>\r\n\t\t\t\tthis._ngZone.run(() => {\r\n\t\t\t\t\tthis.notAvailable = true;\r\n\t\t\t\t\tthis.message = `Update Downloading ${\r\n\t\t\t\t\t\targ.percent ? Math.floor(Number(arg.percent)) : 0\r\n\t\t\t\t\t}%`;\r\n\t\t\t\t\tthis.logContents.push(this.message);\r\n\t\t\t\t\tthis.scrollToBottom();\r\n\t\t\t\t})\r\n\t\t);\r\n\t\tthis.version = this.electronService.remote.app.getVersion();\r\n\t}\r\n\r\n\tcheckForUpdate() {\r\n\t\tthis.loading = true;\r\n\t\tthis.electronService.ipcRenderer.send('check_for_update');\r\n\t}\r\n\r\n\trestartAndUpdate() {\r\n\t\tthis.electronService.ipcRenderer.send('restart_and_update');\r\n\t}\r\n\r\n\tlogBoxChange(e) {\r\n\t\tif (e) {\r\n\t\t\tthis.logIsOpen = false;\r\n\t\t} else {\r\n\t\t\tthis.logIsOpen = true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate scrollToBottom() {\r\n\t\tthis.logBox.nativeElement.scrollTop =\r\n\t\t\tthis.logBox.nativeElement.scrollHeight;\r\n\t}\r\n}\r\n"]}