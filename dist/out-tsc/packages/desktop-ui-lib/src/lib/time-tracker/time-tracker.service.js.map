{"version":3,"file":"time-tracker.service.js","sourceRoot":"","sources":["../../../../../../../packages/desktop-ui-lib/src/lib/time-tracker/time-tracker.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport * as moment from 'moment';\r\nimport { catchError, map, shareReplay, tap } from 'rxjs/operators';\r\nimport { firstValueFrom, throwError } from 'rxjs';\r\nimport { toParams } from '@gauzy/ui-sdk/common';\r\nimport {\r\n\tIGetTasksStatistics,\r\n\tIOrganizationContact,\r\n\tIOrganizationContactCreateInput,\r\n\tIOrganizationProject,\r\n\tIOrganizationProjectCreateInput,\r\n\tIOrganizationTeam,\r\n\tIOrganizationTeamEmployee,\r\n\tIPagination,\r\n\tITaskPriority,\r\n\tITaskSize,\r\n\tITaskSizeFindInput,\r\n\tITaskStatus,\r\n\tITaskStatusFindInput,\r\n\tITaskUpdateInput,\r\n\tTimeLogSourceEnum,\r\n\tTimeLogType\r\n} from '@gauzy/contracts';\r\nimport {\r\n\tClientCacheService,\r\n\tEmployeeCacheService,\r\n\tProjectCacheService,\r\n\tStore,\r\n\tTaskCacheService,\r\n\tTaskPriorityCacheService,\r\n\tTaskSizeCacheService,\r\n\tTaskStatusCacheService,\r\n\tTeamsCacheService,\r\n\tTimeLogCacheService,\r\n\tTimeSlotCacheService,\r\n\tTimeTrackerDateManager\r\n} from '../services';\r\nimport { UserOrganizationService } from './organization-selector/user-organization.service';\r\nimport { LoggerService } from '../electron/services';\r\nimport { API_PREFIX } from '../constants';\r\n\r\n@Injectable({\r\n\tprovidedIn: 'root'\r\n})\r\nexport class TimeTrackerService {\r\n\ttoken = '';\r\n\tuserId = '';\r\n\temployeeId = '';\r\n\r\n\tconstructor(\r\n\t\tprivate readonly http: HttpClient,\r\n\t\tprivate readonly _clientCacheService: ClientCacheService,\r\n\t\tprivate readonly _taskCacheService: TaskCacheService,\r\n\t\tprivate readonly _projectCacheService: ProjectCacheService,\r\n\t\tprivate readonly _timeSlotCacheService: TimeSlotCacheService,\r\n\t\tprivate readonly _employeeCacheService: EmployeeCacheService,\r\n\t\tprivate readonly _userOrganizationService: UserOrganizationService,\r\n\t\tprivate readonly _timeLogService: TimeLogCacheService,\r\n\t\tprivate readonly _loggerService: LoggerService,\r\n\t\tprivate readonly _store: Store,\r\n\t\tprivate readonly _taskStatusCacheService: TaskStatusCacheService,\r\n\t\tprivate readonly _teamsCacheService: TeamsCacheService,\r\n\t\tprivate readonly _taskPriorityCacheService: TaskPriorityCacheService,\r\n\t\tprivate readonly _taskSizeCacheService: TaskSizeCacheService\r\n\t) {}\r\n\r\n\tcreateAuthorizationHeader(headers: Headers) {\r\n\t\theaders.append('Authorization', 'Basic ' + btoa('username:password'));\r\n\t}\r\n\r\n\tasync getTasks(values) {\r\n\t\tconst request = {\r\n\t\t\twhere: {\r\n\t\t\t\torganizationId: values.organizationId,\r\n\t\t\t\ttenantId: values.tenantId,\r\n\t\t\t\t...(values.projectId\r\n\t\t\t\t\t? {\r\n\t\t\t\t\t\t\tprojectId: values.projectId\r\n\t\t\t\t\t  }\r\n\t\t\t\t\t: {}),\r\n\t\t\t\t...(values.organizationTeamId && {\r\n\t\t\t\t\tteams: {\r\n\t\t\t\t\t\tid: values.organizationTeamId\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\trelations: [\r\n\t\t\t\t'project',\r\n\t\t\t\t'tags',\r\n\t\t\t\t'teams',\r\n\t\t\t\t'teams.members',\r\n\t\t\t\t'teams.members.employee',\r\n\t\t\t\t'teams.members.employee.user',\r\n\t\t\t\t'creator',\r\n\t\t\t\t'organizationSprint',\r\n\t\t\t\t'taskStatus',\r\n\t\t\t\t'taskSize',\r\n\t\t\t\t'taskPriority'\r\n\t\t\t],\r\n\t\t\tjoin: {\r\n\t\t\t\talias: 'task',\r\n\t\t\t\tleftJoinAndSelect: {\r\n\t\t\t\t\tmembers: 'task.members',\r\n\t\t\t\t\tuser: 'members.user'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tlet tasks$ = this._taskCacheService.getValue(request);\r\n\t\tif (!tasks$) {\r\n\t\t\ttasks$ = this.http\r\n\t\t\t\t.get(`${API_PREFIX}/tasks/employee/${values.employeeId}`, {\r\n\t\t\t\t\tparams: toParams(request)\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((response: any) => response),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._taskCacheService.setValue(tasks$, request);\r\n\t\t}\r\n\t\treturn firstValueFrom(tasks$);\r\n\t}\r\n\r\n\tpublic async getTasksStatistics(values: IGetTasksStatistics) {\r\n\t\tconst request: IGetTasksStatistics = {\r\n\t\t\torganizationId: values.organizationId,\r\n\t\t\ttenantId: values.tenantId,\r\n\t\t\ttaskIds: values.taskIds,\r\n\t\t\tstartDate: moment(0).utc().toISOString(),\r\n\t\t\tendDate: TimeTrackerDateManager.endToday,\r\n\t\t\ttodayStart: TimeTrackerDateManager.startToday,\r\n\t\t\ttodayEnd: TimeTrackerDateManager.endToday,\r\n\t\t\t...(values.projectId\r\n\t\t\t\t? {\r\n\t\t\t\t\t\tprojectId: values.projectId\r\n\t\t\t\t  }\r\n\t\t\t\t: {})\r\n\t\t};\r\n\t\tconst cacheReference = {\r\n\t\t\ttaskIds: values.taskIds,\r\n\t\t\tprojectId: values.projectId\r\n\t\t};\r\n\t\tlet tasksStatistics$ = this._taskCacheService.getValue(cacheReference);\r\n\t\tif (!tasksStatistics$) {\r\n\t\t\ttasksStatistics$ = this.http\r\n\t\t\t\t.get(`${API_PREFIX}/timesheet/statistics/tasks`, {\r\n\t\t\t\t\tparams: toParams({\r\n\t\t\t\t\t\t...request\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((response: any) => response),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._taskCacheService.setValue(tasksStatistics$, cacheReference);\r\n\t\t}\r\n\t\treturn firstValueFrom(tasksStatistics$);\r\n\t}\r\n\r\n\tasync getEmployees(values) {\r\n\t\tconst params = {\r\n\t\t\tdata: JSON.stringify({\r\n\t\t\t\trelations: ['user'],\r\n\t\t\t\tfindInput: {\r\n\t\t\t\t\torganization: {\r\n\t\t\t\t\t\tid: values.organizationId\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t};\r\n\t\tlet employee$ = this._employeeCacheService.getValue(params);\r\n\t\tif (!employee$) {\r\n\t\t\temployee$ = this.http\r\n\t\t\t\t.get(`${API_PREFIX}/employee/${values.employeeId}`, {\r\n\t\t\t\t\tparams: toParams(params)\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((response: any) => response),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._employeeCacheService.setValue(employee$, params);\r\n\t\t}\r\n\t\treturn firstValueFrom(employee$);\r\n\t}\r\n\r\n\tasync getProjects(values) {\r\n\t\tconst params = {\r\n\t\t\torganizationId: values.organizationId,\r\n\t\t\temployeeId: values.employeeId,\r\n\t\t\ttenantId: values.tenantId,\r\n\t\t\t...(values.organizationContactId\r\n\t\t\t\t? {\r\n\t\t\t\t\t\torganizationContactId: values.organizationContactId\r\n\t\t\t\t  }\r\n\t\t\t\t: {}),\r\n\t\t\t...(values.organizationTeamId && {\r\n\t\t\t\torganizationTeamId: values.organizationTeamId\r\n\t\t\t})\r\n\t\t};\r\n\t\tlet projects$ = this._projectCacheService.getValue(params);\r\n\t\tif (!projects$) {\r\n\t\t\tprojects$ = this.http\r\n\t\t\t\t.get(`${API_PREFIX}/organization-projects/employee/${values.employeeId}`, {\r\n\t\t\t\t\tparams: toParams(params)\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((response: any) => response),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._projectCacheService.setValue(projects$, params);\r\n\t\t}\r\n\t\treturn firstValueFrom(projects$);\r\n\t}\r\n\r\n\tasync getClient(values) {\r\n\t\tconst params = {\r\n\t\t\torganizationId: values.organizationId\r\n\t\t};\r\n\t\tlet clients$ = this._clientCacheService.getValue(params);\r\n\t\tif (!clients$) {\r\n\t\t\tclients$ = this.http\r\n\t\t\t\t.get(`${API_PREFIX}/organization-contact/employee/${values.employeeId}`, {\r\n\t\t\t\t\tparams\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((response: any) => response),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._clientCacheService.setValue(clients$, params);\r\n\t\t}\r\n\t\treturn firstValueFrom(clients$);\r\n\t}\r\n\r\n\tgetUserDetail() {\r\n\t\treturn this._userOrganizationService.detail();\r\n\t}\r\n\r\n\tasync getTimeLogs(values) {\r\n\t\tconsole.log('TimeLogs', values);\r\n\t\tlet timeLogs$ = this._timeLogService.getValue('counts');\r\n\t\tif (!timeLogs$) {\r\n\t\t\ttimeLogs$ = this.http\r\n\t\t\t\t.get(`${API_PREFIX}/timesheet/statistics/counts`, {\r\n\t\t\t\t\tparams: toParams({\r\n\t\t\t\t\t\ttenantId: values.tenantId,\r\n\t\t\t\t\t\torganizationId: values.organizationId,\r\n\t\t\t\t\t\temployeeIds: [values.employeeId],\r\n\t\t\t\t\t\ttodayStart: TimeTrackerDateManager.startToday,\r\n\t\t\t\t\t\ttodayEnd: TimeTrackerDateManager.endToday,\r\n\t\t\t\t\t\tstartDate: TimeTrackerDateManager.startWeek,\r\n\t\t\t\t\t\tendDate: TimeTrackerDateManager.endWeek\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((response: any) => response),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._timeLogService.setValue(timeLogs$, 'counts');\r\n\t\t}\r\n\t\treturn firstValueFrom(timeLogs$);\r\n\t}\r\n\r\n\tasync getTimeSlot(values) {\r\n\t\tthis._loggerService.log.info(`Get Time Slot: ${moment().format()}`);\r\n\t\tconst { tenantId, organizationId } = this._store;\r\n\t\tconst params = toParams({\r\n\t\t\ttenantId,\r\n\t\t\torganizationId,\r\n\t\t\trelations: ['screenshots']\r\n\t\t});\r\n\t\tlet timeSlots$ = this._timeSlotCacheService.getValue(values.timeSlotId);\r\n\t\tif (!timeSlots$) {\r\n\t\t\ttimeSlots$ = this.http\r\n\t\t\t\t.get(`${API_PREFIX}/timesheet/time-slot/${values.timeSlotId}`, {\r\n\t\t\t\t\tparams\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((response: any) => response),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._timeSlotCacheService.setValue(timeSlots$, values.timeSlotId);\r\n\t\t}\r\n\t\treturn firstValueFrom(timeSlots$);\r\n\t}\r\n\r\n\tpingAw(host) {\r\n\t\treturn firstValueFrom(this.http.get(host, { responseType: 'text' }));\r\n\t}\r\n\r\n\ttoggleApiStart(values) {\r\n\t\tconst options = {\r\n\t\t\theaders: new HttpHeaders({ timeout: `${15 * 1000}` })\r\n\t\t};\r\n\t\tconst body = {\r\n\t\t\tdescription: values.description,\r\n\t\t\tisBillable: true,\r\n\t\t\tlogType: TimeLogType.TRACKED,\r\n\t\t\tprojectId: values.projectId,\r\n\t\t\ttaskId: values.taskId,\r\n\t\t\tsource: TimeLogSourceEnum.DESKTOP,\r\n\t\t\tmanualTimeSlot: values.manualTimeSlot,\r\n\t\t\torganizationId: values.organizationId,\r\n\t\t\ttenantId: values.tenantId,\r\n\t\t\torganizationContactId: values.organizationContactId,\r\n\t\t\tisRunning: true,\r\n\t\t\tversion: values.version,\r\n\t\t\tstartedAt: moment(values.startedAt).utc().toISOString(),\r\n\t\t\torganizationTeamId: values.organizationTeamId\r\n\t\t};\r\n\t\tthis._loggerService.log.info(`Toggle Start Timer Request: ${moment().format()}`, body);\r\n\t\treturn firstValueFrom(this.http.post(`${API_PREFIX}/timesheet/timer/start`, { ...body }, options));\r\n\t}\r\n\r\n\ttoggleApiStop(values) {\r\n\t\tconst options = {\r\n\t\t\theaders: new HttpHeaders({ timeout: `${15 * 1000}` })\r\n\t\t};\r\n\t\tconst body = {\r\n\t\t\tdescription: values.description,\r\n\t\t\tisBillable: true,\r\n\t\t\tlogType: TimeLogType.TRACKED,\r\n\t\t\tprojectId: values.projectId,\r\n\t\t\ttaskId: values.taskId,\r\n\t\t\tmanualTimeSlot: values.manualTimeSlot,\r\n\t\t\torganizationId: values.organizationId,\r\n\t\t\ttenantId: values.tenantId,\r\n\t\t\torganizationContactId: values.organizationContactId,\r\n\t\t\tisRunning: false,\r\n\t\t\tversion: values.version,\r\n\t\t\tstartedAt: moment(values.startedAt).utc().toISOString(),\r\n\t\t\tstoppedAt: moment(values.stoppedAt).utc().toISOString(),\r\n\t\t\torganizationTeamId: values.organizationTeamId\r\n\t\t};\r\n\t\tthis._loggerService.log.info(`Toggle Stop Timer Request: ${moment().format()}`, body);\r\n\t\treturn firstValueFrom(this.http.post(`${API_PREFIX}/timesheet/timer/stop`, { ...body }, options));\r\n\t}\r\n\r\n\tdeleteTimeSlot(values) {\r\n\t\tconst params = toParams({\r\n\t\t\tids: [values.timeSlotId],\r\n\t\t\ttenantId: values.tenantId,\r\n\t\t\torganizationId: values.organizationId\r\n\t\t});\r\n\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http.delete(`${API_PREFIX}/timesheet/time-slot`, {\r\n\t\t\t\tparams\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tdeleteTimeSlots(values) {\r\n\t\tconst params = toParams({\r\n\t\t\tids: [...values.timeslotIds],\r\n\t\t\ttenantId: values.tenantId,\r\n\t\t\torganizationId: values.organizationId\r\n\t\t});\r\n\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http.delete(`${API_PREFIX}/timesheet/time-slot`, {\r\n\t\t\t\tparams\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tgetInvalidTimeLog(values) {\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http.get(`${API_PREFIX}/timesheet/time-log/`, {\r\n\t\t\t\tparams: {\r\n\t\t\t\t\ttenantId: values.tenantId,\r\n\t\t\t\t\torganizationId: values.organizationId,\r\n\t\t\t\t\temployeeId: values.employeeId,\r\n\t\t\t\t\tsource: TimeLogSourceEnum.DESKTOP\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tdeleteInvalidTimeLog(values) {\r\n\t\tconst params = toParams({\r\n\t\t\tlogIds: values.timeLogIds\r\n\t\t});\r\n\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http.delete(`${API_PREFIX}/timesheet/time-log`, {\r\n\t\t\t\tparams\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tgetTimerStatus(values) {\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http.get(`${API_PREFIX}/timesheet/timer/status`, {\r\n\t\t\t\tparams: {\r\n\t\t\t\t\ttenantId: values.tenantId,\r\n\t\t\t\t\torganizationId: values.organizationId,\r\n\t\t\t\t\trelations: ['employee', 'employee.user']\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tpushToTimeSlot(values) {\r\n\t\tconsole.log('âœ… - TimeSlot', values);\r\n\t\tconst params = {\r\n\t\t\temployeeId: values.employeeId,\r\n\t\t\tprojectId: values.projectId,\r\n\t\t\tduration: values.duration,\r\n\t\t\tkeyboard: values.keyboard,\r\n\t\t\tmouse: values.mouse,\r\n\t\t\toverall: values.overall,\r\n\t\t\tstartedAt: values.startedAt,\r\n\t\t\tactivities: values.activities,\r\n\t\t\ttimeLogId: values.timeLogId,\r\n\t\t\torganizationId: values.organizationId,\r\n\t\t\ttenantId: values.tenantId,\r\n\t\t\torganizationContactId: values.organizationContactId,\r\n\t\t\trecordedAt: moment(values.recordedAt).utc().toISOString(),\r\n\t\t\t...(values.timesheetId && { timesheetId: values.timesheetId })\r\n\t\t};\r\n\r\n\t\tconsole.log('Params', params);\r\n\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http.post(`${API_PREFIX}/timesheet/time-slot`, params).pipe(\r\n\t\t\t\tcatchError((error) => {\r\n\t\t\t\t\terror.error = {\r\n\t\t\t\t\t\t...error.error,\r\n\t\t\t\t\t\tparams: JSON.stringify(params)\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn throwError(() => new Error(error));\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\tuploadImages(values, img: any) {\r\n\t\tconst formData = new FormData();\r\n\t\tconst contentType = 'image/png';\r\n\t\tconst b64Data = img.b64Img;\r\n\t\tconst blob = this.b64toBlob(b64Data, contentType);\r\n\t\tformData.append('file', blob, img.fileName);\r\n\t\tformData.append('timeSlotId', values.timeSlotId);\r\n\t\tformData.append('tenantId', values.tenantId);\r\n\t\tformData.append('organizationId', values.organizationId);\r\n\t\tformData.append('recordedAt', moment(values.recordedAt).utc().toISOString());\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http.post(`${API_PREFIX}/timesheet/screenshot`, formData).pipe(\r\n\t\t\t\tcatchError((error) => {\r\n\t\t\t\t\terror.error = {\r\n\t\t\t\t\t\t...error.error,\r\n\t\t\t\t\t\tparams: JSON.stringify(formData)\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn throwError(() => new Error(error));\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\tb64toBlob = (b64Data, contentType = '', sliceSize = 512) => {\r\n\t\tconst byteCharacters = atob(b64Data);\r\n\t\tconst byteArrays = [];\r\n\r\n\t\tfor (let offset = 0; offset < byteCharacters.length; offset += sliceSize) {\r\n\t\t\tconst slice = byteCharacters.slice(offset, offset + sliceSize);\r\n\r\n\t\t\tconst byteNumbers = new Array(slice.length);\r\n\t\t\tfor (let i = 0; i < slice.length; i++) {\r\n\t\t\t\tbyteNumbers[i] = slice.charCodeAt(i);\r\n\t\t\t}\r\n\r\n\t\t\tconst byteArray = new Uint8Array(byteNumbers);\r\n\t\t\tbyteArrays.push(byteArray);\r\n\t\t}\r\n\r\n\t\tconst blob = new Blob(byteArrays, { type: contentType });\r\n\t\treturn blob;\r\n\t};\r\n\r\n\tconvertToSlug(text: string) {\r\n\t\treturn text\r\n\t\t\t.toString()\r\n\t\t\t.toLowerCase()\r\n\t\t\t.replace(/\\s+/g, '-') // Replace spaces with -\r\n\t\t\t.replace(/\\-\\-+/g, '-') // Replace multiple - with single -\r\n\t\t\t.replace(/^-+/, '') // Trim - from start of text\r\n\t\t\t.replace(/-+$/, ''); // Trim - from end of text\r\n\t}\r\n\r\n\tasync pingServer(values) {\r\n\t\ttry {\r\n\t\t\tawait this.pingApi(values);\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tif (error.status === 404) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tpingApi(values) {\r\n\t\treturn firstValueFrom(this.http.get(values.apiHost));\r\n\t}\r\n\r\n\tsaveNewTask(values, payload) {\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http.post(`${API_PREFIX}/tasks`, payload).pipe(\r\n\t\t\t\ttap(() => this._taskCacheService.clear()),\r\n\t\t\t\tcatchError((error) => {\r\n\t\t\t\t\terror.error = {\r\n\t\t\t\t\t\t...error.error\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn throwError(() => new Error(error));\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\tcreateNewProject(createInput: IOrganizationProjectCreateInput, data): Promise<IOrganizationProject> {\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http\r\n\t\t\t\t.post<IOrganizationProject>(`${API_PREFIX}/organization-projects`, createInput)\r\n\t\t\t\t.pipe(tap(() => this._projectCacheService.clear()))\r\n\t\t);\r\n\t}\r\n\r\n\tcreateNewContact(input: IOrganizationContactCreateInput, values): Promise<IOrganizationContact> {\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http.post<IOrganizationContact>(`${API_PREFIX}/organization-contact`, input).pipe(\r\n\t\t\t\ttap(() => this._clientCacheService.clear()),\r\n\t\t\t\tcatchError((error) => {\r\n\t\t\t\t\terror.error = {\r\n\t\t\t\t\t\t...error.error\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn throwError(() => new Error(error));\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\tpublic async updateTask(id: string, taskUpdateInput: ITaskUpdateInput) {\r\n\t\treturn firstValueFrom(\r\n\t\t\tthis.http.put<IOrganizationContact>(`${API_PREFIX}/tasks/${id}`, taskUpdateInput).pipe(\r\n\t\t\t\ttap(() => this._taskCacheService.clear()),\r\n\t\t\t\ttap(() => this._taskStatusCacheService.clear()),\r\n\t\t\t\tcatchError((error) => {\r\n\t\t\t\t\terror.error = {\r\n\t\t\t\t\t\t...error.error\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn throwError(() => new Error(error));\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\tpublic async statuses(params: ITaskStatusFindInput): Promise<ITaskStatus[]> {\r\n\t\tlet taskStatuses$ = this._taskStatusCacheService.getValue(params);\r\n\t\tif (!taskStatuses$) {\r\n\t\t\ttaskStatuses$ = this.http\r\n\t\t\t\t.get<IPagination<ITaskStatus>>(`${API_PREFIX}/task-statuses`, {\r\n\t\t\t\t\tparams: toParams({ ...params })\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((res) => res.items),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._taskStatusCacheService.setValue(taskStatuses$, params);\r\n\t\t}\r\n\t\treturn firstValueFrom(taskStatuses$);\r\n\t}\r\n\r\n\tpublic async updateOrganizationTeamEmployee(\r\n\t\temployeeId: string,\r\n\t\tvalues: Partial<IOrganizationTeamEmployee>\r\n\t): Promise<any> {\r\n\t\tconst params = {\r\n\t\t\torganizationId: values.organizationId,\r\n\t\t\tactiveTaskId: values.activeTaskId,\r\n\t\t\torganizationTeamId: values.organizationTeamId,\r\n\t\t\ttenantId: values.tenantId\r\n\t\t};\r\n\t\treturn firstValueFrom(this.http.put(`${API_PREFIX}/organization-team-employee/${employeeId}`, params));\r\n\t}\r\n\r\n\tpublic async getTeams(values?: any): Promise<IOrganizationTeam[]> {\r\n\t\tconst params = {\r\n\t\t\twhere: {\r\n\t\t\t\torganizationId: this._store.organizationId,\r\n\t\t\t\ttenantId: this._store.tenantId,\r\n\t\t\t\t...(values?.projectId && {\r\n\t\t\t\t\tprojects: {\r\n\t\t\t\t\t\tid: values.projectId\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\trelations: ['projects']\r\n\t\t};\r\n\t\tlet teams$ = this._teamsCacheService.getValue(params);\r\n\t\tif (!teams$) {\r\n\t\t\tteams$ = this.http\r\n\t\t\t\t.get<IPagination<IOrganizationTeam>>(`${API_PREFIX}/organization-team/me`, {\r\n\t\t\t\t\tparams: toParams({ ...params })\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((res) => res.items),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._teamsCacheService.setValue(teams$, params);\r\n\t\t}\r\n\t\treturn firstValueFrom(teams$);\r\n\t}\r\n\r\n\tpublic async taskSizes(): Promise<ITaskSize[]> {\r\n\t\tconst params: ITaskSizeFindInput = {\r\n\t\t\torganizationId: this._store.organizationId,\r\n\t\t\ttenantId: this._store.tenantId\r\n\t\t};\r\n\t\tlet taskSizes$ = this._taskSizeCacheService.getValue(params);\r\n\t\tif (!taskSizes$) {\r\n\t\t\ttaskSizes$ = this.http\r\n\t\t\t\t.get<IPagination<ITaskSize>>(`${API_PREFIX}/task-sizes`, {\r\n\t\t\t\t\tparams: toParams({ ...params })\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((res) => res.items),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._taskSizeCacheService.setValue(taskSizes$, params);\r\n\t\t}\r\n\t\treturn firstValueFrom(taskSizes$);\r\n\t}\r\n\r\n\tpublic async taskPriorities(): Promise<ITaskPriority[]> {\r\n\t\tconst params: ITaskSizeFindInput = {\r\n\t\t\torganizationId: this._store.organizationId,\r\n\t\t\ttenantId: this._store.tenantId\r\n\t\t};\r\n\t\tlet taskPriorities$ = this._taskPriorityCacheService.getValue(params);\r\n\t\tif (!taskPriorities$) {\r\n\t\t\ttaskPriorities$ = this.http\r\n\t\t\t\t.get<IPagination<ITaskPriority>>(`${API_PREFIX}/task-priorities`, {\r\n\t\t\t\t\tparams: toParams({ ...params })\r\n\t\t\t\t})\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap((res) => res.items),\r\n\t\t\t\t\tshareReplay(1)\r\n\t\t\t\t);\r\n\t\t\tthis._taskPriorityCacheService.setValue(taskPriorities$, params);\r\n\t\t}\r\n\t\treturn firstValueFrom(taskPriorities$);\r\n\t}\r\n}\r\n"]}