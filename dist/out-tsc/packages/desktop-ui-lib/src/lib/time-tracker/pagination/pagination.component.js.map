{"version":3,"file":"pagination.component.js","sourceRoot":"","sources":["../../../../../../../../packages/desktop-ui-lib/src/lib/time-tracker/pagination/pagination.component.ts"],"names":[],"mappings":"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","sourcesContent":["/* It's a pagination component that works with the angular2-smart-table component */\r\nimport {\r\n\tComponent,\r\n\tEventEmitter,\r\n\tInput,\r\n\tOnChanges,\r\n\tOnDestroy,\r\n\tOutput,\r\n\tSimpleChanges,\r\n} from '@angular/core';\r\nimport { LocalDataSource } from 'angular2-smart-table';\r\nimport { Subscription, tap } from 'rxjs';\r\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\r\n\r\n@UntilDestroy({ checkProperties: true })\r\n@Component({\r\n\tselector: 'ga-pagination',\r\n\ttemplateUrl: './pagination.component.html',\r\n\tstyleUrls: ['./pagination.component.scss'],\r\n})\r\nexport class PaginationComponent implements OnChanges, OnDestroy {\r\n\tprivate _source: LocalDataSource;\r\n\tprivate _perPageSelect: any[];\r\n\tprivate _currentPerPage: any;\r\n\tprivate _pages: Array<any>;\r\n\tprivate _page: number;\r\n\tprivate _count: number = 0;\r\n\tprivate _perPage: number;\r\n\tprivate _changePage: EventEmitter<{ page: number }>;\r\n\tprivate _dataChangedSub: Subscription;\r\n\r\n\tconstructor() {\r\n\t\tthis._changePage = new EventEmitter<{ page: number }>();\r\n\t\tthis._perPageSelect = [5, 10, 25, 50, 100];\r\n\t}\r\n\r\n\tprivate _processPageChange(changes: any) {\r\n\t\tif (changes['action'] === 'prepend') {\r\n\t\t\tthis._source.setPage(1);\r\n\t\t}\r\n\t\tif (changes['action'] === 'append') {\r\n\t\t\tthis._source.setPage(this.last);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _initPages() {\r\n\t\tconst pagesCount = this.last;\r\n\t\tlet showPagesCount = 4;\r\n\t\tshowPagesCount =\r\n\t\t\tpagesCount < showPagesCount ? pagesCount : showPagesCount;\r\n\t\tthis._pages = [];\r\n\r\n\t\tif (this.isShouldShow) {\r\n\t\t\tlet middleOne = Math.ceil(showPagesCount / 2);\r\n\t\t\tmiddleOne = this._page >= middleOne ? this._page : middleOne;\r\n\r\n\t\t\tlet lastOne = middleOne + Math.floor(showPagesCount / 2);\r\n\t\t\tlastOne = lastOne >= pagesCount ? pagesCount : lastOne;\r\n\r\n\t\t\tconst firstOne = lastOne - showPagesCount + 1;\r\n\r\n\t\t\tfor (let i = firstOne; i <= lastOne; i++) {\r\n\t\t\t\tthis._pages.push(i);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic ngOnChanges(changes: SimpleChanges) {\r\n\t\tif (changes.source) {\r\n\t\t\tif (!changes.source.firstChange) {\r\n\t\t\t\tthis._dataChangedSub.unsubscribe();\r\n\t\t\t}\r\n\t\t\tthis._dataChangedSub = this._source\r\n\t\t\t\t.onChanged()\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\ttap((dataChanges) => {\r\n\t\t\t\t\t\tthis._page = this._source.getPaging().page;\r\n\t\t\t\t\t\tthis._perPage = this._source.getPaging().perPage;\r\n\t\t\t\t\t\tthis._currentPerPage = this._perPage;\r\n\t\t\t\t\t\tthis._count = this._source.count();\r\n\t\t\t\t\t\tif (this.isPageOutOfBounce) {\r\n\t\t\t\t\t\t\tthis._source.setPage(--this._page);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis._processPageChange(dataChanges);\r\n\t\t\t\t\t\tthis._initPages();\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tuntilDestroyed(this)\r\n\t\t\t\t)\r\n\t\t\t\t.subscribe();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic get isShouldShow(): boolean {\r\n\t\treturn this._source.count() > this._perPage;\r\n\t}\r\n\r\n\tpublic paginate(page: number): boolean {\r\n\t\tthis._source.setPage(page);\r\n\t\tthis._page = page;\r\n\t\tthis.changePage.emit({ page });\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic next(): boolean {\r\n\t\treturn this.paginate(this._page + 1);\r\n\t}\r\n\r\n\tpublic prev(): boolean {\r\n\t\treturn this.paginate(this._page - 1);\r\n\t}\r\n\r\n\tpublic get last(): number {\r\n\t\treturn Math.ceil(this._count / this._perPage);\r\n\t}\r\n\r\n\tpublic get isPageOutOfBounce(): boolean {\r\n\t\treturn (\r\n\t\t\tthis._page * this._perPage >= this._count + this._perPage &&\r\n\t\t\tthis._page > 1\r\n\t\t);\r\n\t}\r\n\r\n\tpublic onChangePerPage(event: any) {\r\n\t\tthis._currentPerPage = event;\r\n\t\tconsole.log('PerPage', event);\r\n\t\tif (this._currentPerPage) {\r\n\t\t\tif (\r\n\t\t\t\ttypeof this._currentPerPage === 'string' &&\r\n\t\t\t\tthis._currentPerPage.toLowerCase() === 'all'\r\n\t\t\t) {\r\n\t\t\t\tthis._source.getPaging().perPage = null;\r\n\t\t\t} else {\r\n\t\t\t\tthis._source.getPaging().perPage = this._currentPerPage * 1;\r\n\t\t\t\tthis._source.refresh();\r\n\t\t\t}\r\n\t\t\tthis._initPages();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic get startCount() {\r\n\t\treturn (this._page - 1) * this._perPage + 1;\r\n\t}\r\n\tpublic get endCount() {\r\n\t\tconst entriesEndPage: number =\r\n\t\t\t(this._page - 1) * this._perPage + this._perPage;\r\n\r\n\t\tif (entriesEndPage > this._count) {\r\n\t\t\treturn this._count;\r\n\t\t}\r\n\t\treturn entriesEndPage;\r\n\t}\r\n\r\n\t@Input()\r\n\tpublic set source(value: LocalDataSource) {\r\n\t\tthis._source = value;\r\n\t}\r\n\tpublic get source(): LocalDataSource {\r\n\t\treturn this._source;\r\n\t}\r\n\r\n\t@Input()\r\n\tpublic set perPageSelect(values: any[]) {\r\n\t\tthis._perPageSelect = values;\r\n\t}\r\n\r\n\tpublic get perPageSelect(): any[] {\r\n\t\treturn this._perPageSelect;\r\n\t}\r\n\r\n\tpublic get currentPerPage(): any {\r\n\t\treturn this._currentPerPage;\r\n\t}\r\n\tpublic set currentPerPage(value: any) {\r\n\t\tthis._currentPerPage = value;\r\n\t}\r\n\tprotected get pages(): Array<any> {\r\n\t\treturn this._pages;\r\n\t}\r\n\tprotected set pages(value: Array<any>) {\r\n\t\tthis._pages = value;\r\n\t}\r\n\r\n\tprotected get page(): number {\r\n\t\treturn this._page;\r\n\t}\r\n\tprotected set page(value: number) {\r\n\t\tthis._page = value;\r\n\t}\r\n\r\n\tprotected get count(): number {\r\n\t\treturn this._count;\r\n\t}\r\n\tprotected set count(value: number) {\r\n\t\tthis._count = value;\r\n\t}\r\n\tprotected get perPage(): number {\r\n\t\treturn this._perPage;\r\n\t}\r\n\tprotected set perPage(value: number) {\r\n\t\tthis._perPage = value;\r\n\t}\r\n\t@Output()\r\n\tpublic get changePage(): EventEmitter<{ page: number }> {\r\n\t\treturn this._changePage;\r\n\t}\r\n\tprotected get dataChangedSub(): Subscription {\r\n\t\treturn this._dataChangedSub;\r\n\t}\r\n\tprotected set dataChangedSub(value: Subscription) {\r\n\t\tthis._dataChangedSub = value;\r\n\t}\r\n\tngOnDestroy(): void { }\r\n}\r\n"]}